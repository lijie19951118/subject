import{_ as F,u as B,g as S,r as y,f as R,h as T,l as U,i as z,j as h,k as L,d as N,e as q,E as $}from"./index-ded983bc.js";import{c as H,a as k,Z as j,l as c,m as A,p as d,U as l,O as a,T as D,u as x,M as _,S as f,R as v,av as O,aw as Z}from"./myVue-ccd9a49f.js";const G="/login-image.svg";const J=m=>(O("data-v-0f56d9f3"),m=m(),Z(),m),K={class:"main"},P=J(()=>d("img",{class:"login-img",src:G,alt:""},null,-1)),Q={class:"login"},W={class:"title"},X={class:"code-content"},Y=["innerHTML"],ee={__name:"index",setup(m){const E=(o,e,r)=>{if(console.log(o),!e)return r(new Error("请输入用户名"));if(!/^[a-z]{4,}$/i.test(e))return r(new Error("请输入4位以上，英文字母"));r()};B();const b=S();H();const V=k(""),i=k("login"),u=k(),s=j({username:"",password:"",code:""}),w=o=>{i.value=o,u.value.resetFields()},p=async()=>{const{result:o}=await y({url:"/users/login/code",method:"get"});V.value=o},C=()=>{u.value&&u.value.validate(async o=>{if(!o)return;const{code:e,message:r,result:t}=await y({url:"/users/login",method:"post",data:{user_name:s.username,password:s.password,code:s.code}});e===0?(localStorage.setItem("token",t.token),h.success("登录成功！"),b.push("/")):p()})},I=()=>{u.value&&u.value.validate(async o=>{if(!o)return;await L.confirm("是否确认注册账号？",{type:"warning"});const{code:e,message:r,result:t}=await y({url:"/users/register",method:"post",data:{user_name:s.username,password:s.password,code:s.code}});if(e!==0){p();return}h.success("注册成功！"),w("login"),s.username=t.user_name})};return p(),(o,e)=>{const r=N,t=q,g=$,M=R;return c(),A("div",K,[P,d("div",Q,[l(M,{ref_key:"ruleFormRef",ref:u,model:s,"label-width":"auto",class:"demo-ruleForm","status-icon":""},{default:a(()=>[d("div",W,D(i.value==="login"?"欢迎登录Li-Admin":"注册账号"),1),l(t,{prop:"username",rules:[{validator:E,trigger:"blur"}]},{default:a(()=>[l(r,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=n=>s.username=n),modelModifiers:{trim:!0},clearable:"",placeholder:"账号","prefix-icon":x(T),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1},8,["rules"]),l(t,{prop:"password",rules:[{required:!0,message:"请输入密码",trigger:"blur"},{min:4,message:"请输入至少4位字符",trigger:"blur"}]},{default:a(()=>[l(r,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=n=>s.password=n),modelModifiers:{trim:!0},clearable:"","show-password":"",placeholder:"密码","prefix-icon":x(U),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),l(t,{prop:"code",rules:[{required:!0,message:"请输入验证码",trigger:"blur"}]},{default:a(()=>[d("div",X,[l(r,{class:"code-input",modelValue:s.code,"onUpdate:modelValue":e[2]||(e[2]=n=>s.code=n),modelModifiers:{trim:!0},clearable:"",placeholder:"验证码","prefix-icon":x(z),size:"large"},null,8,["modelValue","prefix-icon"]),d("div",{innerHTML:V.value,onClick:p},null,8,Y)])]),_:1}),l(t,null,{default:a(()=>[i.value==="login"?(c(),_(g,{key:0,class:"login-btn",type:"primary",onClick:C},{default:a(()=>[f("登录")]),_:1})):v("",!0),i.value==="register"?(c(),_(g,{key:1,class:"login-btn",type:"success",onClick:I},{default:a(()=>[f("注册")]),_:1})):v("",!0)]),_:1}),d("div",null,[i.value==="login"?(c(),_(g,{key:0,class:"register",type:"primary",link:"",onClick:e[3]||(e[3]=n=>w("register"))},{default:a(()=>[f(" 立即注册 ")]),_:1})):v("",!0),i.value==="register"?(c(),_(g,{key:1,class:"register",type:"success",link:"",onClick:e[4]||(e[4]=n=>w("login"))},{default:a(()=>[f(" 去登陆 ")]),_:1})):v("",!0)])]),_:1},8,["model"])])])}}},re=F(ee,[["__scopeId","data-v-0f56d9f3"]]);export{re as default};
