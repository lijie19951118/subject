import{_ as B,u as S,l as T,r as y,f as R,m as U,n as q,o as z,q as b,g as L,d as N,e as $,E as D}from"./index-6396f8f6.js";import{a as k,Z as H,l as m,m as A,p as d,U as a,O as l,T as K,u as x,M as _,S as f,R as v,av as O,aw as Z}from"./myVue-ccd9a49f.js";const j="/login-image.svg";const G=p=>(O("data-v-e1dce6ed"),p=p(),Z(),p),J={class:"main"},P=G(()=>d("img",{class:"login-img",src:j,alt:""},null,-1)),Q={class:"login"},W={class:"title"},X={class:"code-content"},Y=["innerHTML"],ee={__name:"index",setup(p){const C=(o,e,t)=>{if(console.log(o),!e)return t(new Error("请输入用户名"));if(!/^[a-z]{4,}$/i.test(e))return t(new Error("请输入4位以上，英文字母"));t()};S();const I=T(),V=k(""),n=k("login"),u=k(),s=H({username:"",password:"",code:""}),w=o=>{n.value=o,u.value.resetFields()},c=async()=>{s.code="";const{result:o}=await y({url:`/users/login/code?time=${new Date().getTime()}`,method:"get"});V.value=o},h=()=>{u.value&&u.value.validate(async o=>{if(!o)return;const{code:e,message:t,result:r}=await y({url:"/users/login",method:"post",data:{user_name:s.username,password:s.password,code:s.code}});e===0?(localStorage.setItem("token",r.token),b.success("登录成功！"),I.push("/recreation/chat")):c()})},E=()=>{u.value&&u.value.validate(async o=>{if(!o)return;await L.confirm("是否确认注册账号？",{type:"warning"});const{code:e,message:t,result:r}=await y({url:"/users/register",method:"post",data:{user_name:s.username,password:s.password,code:s.code}});if(e!==0){c();return}b.success("注册成功！"),w("login"),s.username=r.user_name,c()})};c();function M(o){o.keyCode===13&&(n.value==="login"?h():E())}return(o,e)=>{const t=N,r=$,g=D,F=R;return m(),A("div",J,[P,d("div",Q,[a(F,{ref_key:"ruleFormRef",ref:u,model:s,"label-width":"auto",class:"demo-ruleForm","status-icon":""},{default:l(()=>[d("div",W,K(n.value==="login"?"欢迎登录Li-Admin":"注册账号"),1),a(r,{prop:"username",rules:[{validator:C,trigger:"blur"}]},{default:l(()=>[a(t,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=i=>s.username=i),modelModifiers:{trim:!0},clearable:"",placeholder:"账号","prefix-icon":x(U),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1},8,["rules"]),a(r,{prop:"password",rules:[{required:!0,message:"请输入密码",trigger:"blur"},{min:4,message:"请输入至少4位字符",trigger:"blur"}]},{default:l(()=>[a(t,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=i=>s.password=i),modelModifiers:{trim:!0},clearable:"","show-password":"",placeholder:"密码","prefix-icon":x(q),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),a(r,{prop:"code",rules:[{required:!0,message:"请输入验证码",trigger:"blur"}]},{default:l(()=>[d("div",X,[a(t,{class:"code-input",modelValue:s.code,"onUpdate:modelValue":e[2]||(e[2]=i=>s.code=i),modelModifiers:{trim:!0},clearable:"",placeholder:"验证码","prefix-icon":x(z),size:"large",onKeydown:M},null,8,["modelValue","prefix-icon"]),d("div",{innerHTML:V.value,onClick:c},null,8,Y)])]),_:1}),a(r,null,{default:l(()=>[n.value==="login"?(m(),_(g,{key:0,class:"login-btn",type:"primary",onClick:h},{default:l(()=>[f("登录")]),_:1})):v("",!0),n.value==="register"?(m(),_(g,{key:1,class:"login-btn",type:"success",onClick:E},{default:l(()=>[f("注册")]),_:1})):v("",!0)]),_:1}),d("div",null,[n.value==="login"?(m(),_(g,{key:0,class:"register",type:"primary",link:"",onClick:e[3]||(e[3]=i=>w("register"))},{default:l(()=>[f(" 立即注册 ")]),_:1})):v("",!0),n.value==="register"?(m(),_(g,{key:1,class:"register",type:"success",link:"",onClick:e[4]||(e[4]=i=>w("login"))},{default:l(()=>[f(" 去登陆 ")]),_:1})):v("",!0)])]),_:1},8,["model"])])])}}},te=B(ee,[["__scopeId","data-v-e1dce6ed"]]);export{te as default};
