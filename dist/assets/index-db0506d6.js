import{A as B,u as S,r as y,i as T,f as m,g as z,j as d,k as l,l as a,y as L,t as N,I as k,a6 as R,a7 as U,a8 as $,D as _,m as f,h as v,O as q,P as D,E,n as A,s as H,x as j,p as K}from"./vendor-d9749800.js";import{_ as O,r as x}from"./index-03982bc1.js";const P="/login-image.svg";const G=p=>(q("data-v-0bd6ad4f"),p=p(),D(),p),J={class:"main"},Q=G(()=>d("img",{class:"login-img",src:P,alt:""},null,-1)),W={class:"login"},X={class:"title"},Y={class:"code-content"},Z=["innerHTML"],ee={__name:"index",setup(p){const C=(o,e,t)=>{if(console.log(o),!e)return t(new Error("请输入用户名"));if(!/^[a-z]{4,}$/i.test(e))return t(new Error("请输入4位以上，英文字母"));t()};B();const I=S(),V=y(""),n=y("login"),u=y(),s=T({username:"test",password:"1111",code:""}),w=o=>{n.value=o,u.value.resetFields()},c=async()=>{s.code="";const{result:o}=await x({url:`/users/login/code?time=${new Date().getTime()}`,method:"get"});V.value=o},b=()=>{u.value&&u.value.validate(async o=>{if(!o)return;const{code:e,message:t,result:r}=await x({url:"/users/login",method:"post",data:{user_name:s.username,password:s.password,code:s.code}});e===0?(localStorage.setItem("token",r.token),E.success("登录成功！"),I.push("/recreation/chat")):c()})},h=()=>{u.value&&u.value.validate(async o=>{if(!o)return;await A.confirm("是否确认注册账号？",{type:"warning"});const{code:e,message:t,result:r}=await x({url:"/users/register",method:"post",data:{user_name:s.username,password:s.password,code:s.code}});if(e!==0){c();return}E.success("注册成功！"),w("login"),s.username=r.user_name,c()})};c();function F(o){o.keyCode===13&&(n.value==="login"?b():h())}return(o,e)=>{const t=H,r=j,g=K,M=L;return m(),z("div",J,[Q,d("div",W,[l(M,{ref_key:"ruleFormRef",ref:u,model:s,"label-width":"auto",class:"demo-ruleForm","status-icon":""},{default:a(()=>[d("div",X,N(n.value==="login"?"欢迎登录Li-Admin":"注册账号"),1),l(r,{prop:"username",rules:[{validator:C,trigger:"blur"}]},{default:a(()=>[l(t,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=i=>s.username=i),modelModifiers:{trim:!0},clearable:"",placeholder:"账号","prefix-icon":k(R),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1},8,["rules"]),l(r,{prop:"password",rules:[{required:!0,message:"请输入密码",trigger:"blur"},{min:4,message:"请输入至少4位字符",trigger:"blur"}]},{default:a(()=>[l(t,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=i=>s.password=i),modelModifiers:{trim:!0},clearable:"","show-password":"",placeholder:"密码","prefix-icon":k(U),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),l(r,{prop:"code",rules:[{required:!0,message:"请输入验证码",trigger:"blur"}]},{default:a(()=>[d("div",Y,[l(t,{class:"code-input",modelValue:s.code,"onUpdate:modelValue":e[2]||(e[2]=i=>s.code=i),modelModifiers:{trim:!0},clearable:"",placeholder:"验证码","prefix-icon":k($),size:"large",onKeydown:F},null,8,["modelValue","prefix-icon"]),d("div",{innerHTML:V.value,onClick:c},null,8,Z)])]),_:1}),l(r,null,{default:a(()=>[n.value==="login"?(m(),_(g,{key:0,class:"login-btn",type:"primary",onClick:b},{default:a(()=>[f("登录")]),_:1})):v("",!0),n.value==="register"?(m(),_(g,{key:1,class:"login-btn",type:"success",onClick:h},{default:a(()=>[f("注册")]),_:1})):v("",!0)]),_:1}),d("div",null,[n.value==="login"?(m(),_(g,{key:0,class:"register",type:"primary",link:"",onClick:e[3]||(e[3]=i=>w("register"))},{default:a(()=>[f(" 立即注册 ")]),_:1})):v("",!0),n.value==="register"?(m(),_(g,{key:1,class:"register",type:"success",link:"",onClick:e[4]||(e[4]=i=>w("login"))},{default:a(()=>[f(" 去登陆 ")]),_:1})):v("",!0)])]),_:1},8,["model"])])])}}},te=O(ee,[["__scopeId","data-v-0bd6ad4f"]]);export{te as default};
